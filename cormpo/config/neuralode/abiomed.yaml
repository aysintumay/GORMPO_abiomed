# Neural ODE Configuration for Abiomed Dataset

# Device settings
device: cuda
devid: 0

# Model architecture
input_dim: 15  # Will be overridden based on actual data (obs_dim + action_dim)
hidden_dims: [512, 512]
activation: silu  # Options: silu, tanh
time_dependent: true

# ODE solver settings
solver: dopri5  # Options: dopri5, rk4, euler
t0: 0.0
t1: 1.0
rtol: 1.0e-5
atol: 1.0e-5

# Training parameters
epochs: 200
batch_size: 512
lr: 0.001
weight_decay: 0.0
log_every: 100
checkpoint_every: 50  # 0 to disable checkpointing

# Data settings
use_rl_data: true
val_ratio: 0.2
test_ratio: 0.2
train_ratio: 0.6

# OOD detection settings
anomaly_fraction: 0.01  # 1% percentile for threshold

# Model save settings
model_save_path: /public/gormpo/models/abiomed/neuralode/abiomed_neuralode
out_dir: cormpo/checkpoints/neuralode

# Random seed
seed: 42

# Verbosity
verbose: true
plot_results: true

# Abiomed specific settings
task: abiomed
model_name: 10min_1hr_all_data
model_path_wm: /abiomed/downsampled/models/10min_1hr_all_data_model.pth
data_path_wm: /abiomed/downsampled/10min_1hr_all_data.pkl
max_steps: 6
gamma1: 0.0
gamma2: 0.0
gamma3: 0.0
noise_rate: 0.0
noise_scale: 0.0
action_space_type: continuous

# Observation and action dimensions for Abiomed
# These will be inferred from the environment
obs_dim: [14]  # Abiomed observation dimension
action_dim: 1  # Abiomed action dimension (pump level)
